package com.duapps.affair.demo.elasticsearch.service.impl;import com.duapps.affair.demo.elasticsearch.service.EsIndexService;import org.springframework.data.elasticsearch.core.ElasticsearchOperations;import org.springframework.data.elasticsearch.core.IndexOperations;import org.springframework.data.elasticsearch.core.document.Document;import org.springframework.stereotype.Service;import javax.annotation.Resource;/** * @Author he.zhou * @Date 2020-08-25 */@Servicepublic class EsIndexServiceImpl implements EsIndexService {    @Resource    protected ElasticsearchOperations operations;    @Override    public <T> boolean createIndex(Class<T> t) {        IndexOperations indexOperations = operations.indexOps(t);        boolean createIndexRes = indexOperations.create();        if (!createIndexRes) {            return false;        }        Document document = indexOperations.createMapping();        return indexOperations.putMapping(document);    }    @Override    public <T> boolean deleteIndex(Class<T> t) {        return operations.indexOps(t).delete();    }    @Override    public <T> boolean reCreate(Class<T> t) {        IndexOperations indexOperations = operations.indexOps(t);        return indexOperations.delete() && indexOperations.create();    }    @Override    public <T> boolean indexExists(Class<T> t) {        return operations.indexOps(t).exists();    }}